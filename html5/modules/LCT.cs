import flash.external.ExternalInterface;
/////Input Parameters//////
var armseq:String;
var vid:String;
var pid:String;
var uid:String;
var rid:String;
var RandomisationNumber:String;
var Initials:String;
var nexttestname:String;
var testtimelimit:Number;
///////////////////////
var testNumber:Number;
var strings:Array = new Array(
					new Array("urCs iVpioTxorEdaq siHeEoukT ksaQx KwkeL","IsS eruNqnU krasxCbLwbIabRxfvqbXr T tdke",
							  "cQbahUxAuiSwRhxpfhik MbkPzgtZw iv H Npaa","ZnuuUa gRriicAll hEh klZgKwBqjEZ rnqcquj",
							  "srZgeNb Xquh bPaiqNxfv m vDuNvkiDxPrFfyg","lvstNyeLgu UAtr tovhufAcgF oI qOqvZngaDm",
							  "w McXkAgnDxIhaelQbwng cwUh dyUmphZDuog l","mwGjiynbYjlsvKrSfQuqcJ hcSm mPpAos vLr r",
							  "hvsc NoR pI aznvVybapvvL pQVsGghjlsDiRyt","h swugd aBZvpdnYq FXiicce jskOnSvPunqBMv",
							  "yg pGzZtXalHsuWxiEybzmzxFX z z rNzhctePi","auHaMjzl gasUr hF ObtesTdoXzVmVj hIwfspj",
							  "tJfjR rmqxXjl NvNqrmc JdceHcX hbmjMzegLy","cuyIiksFzOvBoPbofbqk e ekZvNyg lLmFOdi c",
							  "DyzD ku yvpWzv RpZmbnaHjHVftgPzigttMxz s","wIqB bxnMidOwaJxpxgsi syQovY rzqNtarA Ef",
							  "giZcnerl Ajx WpPFn jzauuefyYcbAocqBvBZ b","dvPcdfF fQNam wnVrmipobjIzbX tePjkYwma V",
							  "wsIwkRl BteyEpQhfrvu UsbsDzawe TD bjvhUs","hzOHqzD hvoxipPt C ejeABrgk ccBqvnUbnuQx"),
					new Array("wbiLmpp I cgmrAfvIZadfj rycZMeFh wkswXiD","Gnpdt Uvlh ZhEtbvSm xbcsFyzkbIvrE QcuNik",
							  "oxkGeXtcOjWil rRs rokLziftxcin ShZVzy fW","tvXLxualYu nqHsxNorhjsGs Bzdt DT abdfdBh",
							  "c ByvxaMaqmvZLwzFgxllA Rr jWpHvR rybvyeu","ujTbqAfwrQinb naA JclWpXgiWxagGy heLw gi",
							  "y Bs qT ozGsvoNxgRepumqQzZDaRfrdoh gtMzv","wTy dd oHnW vX izvDlqnbqheyTkmoIfavKhWzS",
							  "idC fJnuRf dAiMfjjmlfr bDptTamV vdSyzcSm","wjYyF bdfVlplUb OpwoumQlitHk iFyuLb fFvg",
							  "EztvsnM idSlMppDrjc uvgAjirEn qmY kvAlzG","SxhmwWxoJr Bypvy GqeivrOjCczBH mryG ojnu",
							  "b hb KtWZojamqmjQXv chNc cilDzaVrCLiywuc","fPEjkNR nliWcjgojz mlH pnDjvrtEztJzdtZ a",
							  "gCcga kJPbbyf f VXgzjsoev adVuZnnjVdJhNz","JClfpiBYajzjc Spdndmm fKcQmFio lgcP aLum",
							  "QyjgUxf DngnFfRc ju izG jXdQojvQkuZpdrop","iBoeoFL Ra vvhIfugoyrxu Wr RhftrhlivZHtM",
							  "QsTixebFwJrq iNlow tb jywJm kbSphDiXekPv","Bnz fIobhRgi YzxAmflzxhHkYThszkI jcF qfn"),
					new Array("OajlPAy xxNfjV dqwzlrfSWooFyvr s YGnexby","w uYSUdcaxqTjcgqgozxgeMtWzg V evNdXru zB",
							  "ZcnsheK ryWOcrY lZQjmxsgivVfo Cxffzz Rwc","qXcfa vjhYh aEmDdfOcjjmRzm bRagscSym zGU",
							  "yckbC lyykyfmb iuqntinvvyxTL LSmMZNQt hW","j VCavzMktMoEifkdl w tcyBaML decwMldRgbw",
							  "dybr vdXgsSigXfYWhe rT WcpUnTXujbw zbzdj","VwjtNru grkUxC Ym mglM gIfxgNuuuyZyfeQzl",
							  "oUsdgvoktNYpKcO yLhacnh r mmKYxPh rzYkbc","EhZvyuqCtwXud jzYkgqbAg cVaYwejZ r Sixyk",
							  "wgiWdo D QJeohmln kobMrVrm EfzUukykmVbxS","dbvzV dqerid guKwLGKjyrcreAkL ilSpvTt kZ",
							  "KLqt XukGfzr kohjwwzgyvahabfBE pvNIbYa P","R slrfvArdm ezQpaniaPimNjg Il EwGorwBjTx",
							  "kgaDp dvSNqztqJU ta ewabcrniv xfeNLCuKUf","Lsgan s EIQfshTeIbsckj dmlczkH stqriSRCe",
							  "djeQ nezedAhMwjY QglrcwS QgfeqsU WzZdmnj","ycB bciGLecXG iZcUuTplbn wiwcpkbPkuit iG",
							  "mzvtzvgnxxz LlJhkR jNm DDbDheumOm atyyBT","eaMH mCu mveayazkaAiBcjUdJb zAwUuko znbP"),
					new Array("t o JxMzmKyRzlawr dvHtaumEksmEwE zMVrbPp","xaXgpnaEQ lbzIomX guxblqoDijKs xllkTD Qr",
							  "rvZty j sniorcyHqjyEMYnSqvgAv RixmM xpUe","otrpUm llgyla veENBQwFMk usynIa ZyvnznYp",
							  "lKbr tAmtLAGaoczh pSDbtVyvE jhgiJ hjnndo","bOvfD tyhvPpvodNpeKM tneZ b AyTwrSovdlqr",
							  "MfrjYnSu lazkmVAcGNwyApfxqa youy a FNssh","l eqb wx sMzhlfXfhBnojygLZVaw uCfGjhSeIo",
							  "Ktlrk iZuZqlwwaLk wiJmjl vq EkrOusVgHjTq","ekYiNxIsmkpEt YKdgtexefhN SqmqqGeuw Vu v",
							  "jcRr iaxhgRs bEjw jzPB vaXjtXfDhoZemvmQh","cerEocx dMkcL cxovBGA R gnGgzvrDfrnlyAbt",
							  "bxxR yr bVGbfrymccpcL WkSbJQSoazMq yplye","huzhvjwu go PxuWXnlriBql UUpNxPvazF Nnde",
							  "Rvc ed Rrqdxt NjOVCuiitLdRe LumsclcjUyro","eeUQ fbEnaOtvvbMpFghOeesbZch E obkdyMc p",
							  "y mgyAiwkiQ kronoylopRKJDiMqv cSbSrd Blq","gaYnUsAgvcSdiqkpHWrGq t fty yYnmwzvMD vx",
							  "ymDB ab dEhpSp GsfhnNQrj nzbHDyqhlRwophq","pcp ggiYKFunwSj jhrytYruTd lWuiQ buWubKq"),
					new Array("uSGulxg vz puQggWuOljWuu G ujYzRcudEhqaw","cjHmkKlHxwGwbu quy Lwo Tpb PvzSuIwfdrBco",
							  "Ab x BipymfghiqdTzUawJiK DmjwczWOccn xcL","rJmkFj vNtxtvFUfrndkfzrAZ SueN cacGx wmq",
							  "bnLI nnkxoMffa b JntkGgbetPeRwtwJ fFvvTe","tb n IugzLwvW akikLenhlBicXisasmbQz WRJc",
							  "zWkeImifwprRho qPnZ c QbmbRfbjhxo GKccXh","kShQeJho mK DqngrqBhv daxxl nrKlePumNgCb",
							  "o WvjrXlelfeCo cjVbdA TfCdaTcaN rjkqQroj","wOvCkaYFxinNcnIgd hxyQ WkhQt plHj hyreif",
							  "lr WygU ddCzgnnovUwAyanwKZmhnQt d BMpaxj","tMglNusi Kjp vgdYsn yaty dTnlysBxCuFrGyX",
							  "vGlEeKukNri cWfhbtvksogguu WE fTcW Bycve","fGjhm WoQeiO drjLcYom zKzddwqd AbeOanIsk",
							  "aesDKbfPkLkhLzSePoXq mm g Q ximccntahuMq","pWmnQosRs zyfhT xrQg CzRtdp uksczjOsgTpG",
							  "GpnswfgPNbf unUwTvBug domwW clGsWatxXn f","qLNz HasbyRm KjPyogtTcRheybdq uE suYcfnv",
							  "pKFpr r PhojiKyssGjttvyQ foRqPcyve CwfBu","Pv qvGn elyc rzbsujwdpdcdVeZOyIbXJ AgzOa"),
					new Array("udqCgbpxFnM Ui wt ejbmlt cqzYnvEngBsXRzT","uOrwPgjZeLlflTqaj xR VntlwgsahGq fcrG Am",
							  "sUo h wnpkFxMkyrFxNqav iEFmlUdRtidwhf As","JGforz M yStrMiyXywytfp bJErJcFoedtd jgc",
							  "sFgdxrcH ombu zGxkIWssMgRj ntBhqQrywN zj","eSwqZw IxBwhutm Mrovm jnqwXhXyhaogmUzM O",
							  "bGp Zqb lpkJjxn ovfszXvwJuAeQbp AXlfHfat","Zj iiUbkAurTbgTlzpqdH i udEiYnaiiRnnk Rq",
							  "cLz qvkGiu codbvNCmzyss tOyaIdtX OHuGncm","ri koQjmGZuDxMkdpxow PsgUlg wM slYsTmant",
							  "rAexj jy qshiC wsfPehcQ dXxrbBYoTuEqjhZl","lWqEpsAVwWIcrgVmuf eaytrxpZmU mnRdz e og",
							  "th pnhckefo z LTqDtmOvkFroNwuFkJsmDiFi w","ij Ju dAlhtpba UwhrMsgoPvWdqUitQemJhs fK",
							  "ui jaPtLeolyxRrP nzPriQwKozHcx ktlo KjCy","Lnq mcjk vd WmhivzIfj wntpLWhPazNhueOuZT",
							  "YavjDFscmwKnmtgEz skuVoh Z wO dsNywYynqk","dw gYvVRjwHomk fzrXbcoWIk zygCaih fqynRM",
							  "C eBhoCauutDszCfFsDmpKs zov QusOyrjb zrs","gL k ktFZceCxMfkrhuaX yWhefB CbXuswqbrht"),
					new Array("vGlEeKukNri cWfhbtvksogguu WE fTcW Bycve","fGjhm WoQeiO drjLcYom zKzddwqd AbeOanIsk",
							  "aesDKbfPkLkhLzSePoXq mm g Q ximccntahuMq","pWmnQosRs zyfhT xrQg CzRtdp uksczjOsgTpG",
							  "th pnhckefo z LTqDtmOvkFroNwuFkJsmDiFi w","ij Ju dAlhtpba UwhrMsgoPvWdqUitQemJhs fK",
							  "ui jaPtLeolyxRrP nzPriQwKozHcx ktlo KjCy","lnq mcjk vD WmhivzIfj wntpLWhPazNhueOuZT",
							  "GpnswfgPNbf unUwTvBug domwW clGsWatxXn f","qLNz HasbyRm KjPyogtTcRheybdq uE suYcfnv",
							  "pKFpr r PhojiKyssGjttvyQ foRqPcyve CwfBu","Pv qvGn elyc rzbsujwDpdCdVezoyIbXJ AgzOa",
							  "YavjDFscMwKnmtgEz skuVoh z wO dsNywYynqk","dw gYvVRjwHomk fzrXbcoWIk zygCaiH Fqynrm",
							  "C eBhoCauutDszCfFsDmpKs zov QusOyrjb zrs","gL k ktFZceCxMfkrhuAx yWhefb cbXusWqbRht",
							  "o WvjrXleLfeCo CjVbda TfCdatcaN rjkqQroj","wOvCkaYFxinNcnIgd hxyQ WkhQt plHj hyreif",
							  "lr WygU ddCzgnnovUwAyanwKZmhnQt d BMpaxj","tMglnusi Kjp vgdYsn yatY dTnlysBxCuFrGyX")
					);
var instructions:Array = new Array("Look for the CAPITAL LETTERS on each line. \n"+
								   "Click each CAPITAL LETTER with the left button on the mouse. \n"+
								   "Go from left to right",
								   "Look for the CAPITAL LETTERS on each line\n."+
								   "Click each CAPITAL LETTER with the left button on the mouse\n"+
								   "Go from left to right",
								   "Look for the DOUBLE SPACES on each line. \n"+
								   "Click the letters BEFORE and AFTER the DOUBLE SPACES with the left button on the mouse\n"+
								   "Go from left to right",
								   "Look for the DOUBLE SPACES on each line. \n"+
								   "Click the letters BEFORE and AFTER the DOUBLE SPACES with the left button on the mouse\n"+
								   "Go from left to right",
								   "Look for the CAPITAL LETTERS and DOUBLE SPACES on each line.\n "+
								   "Click each CAPITAL LETTER and the letters BEFORE and AFTER the DOUBLE SPACES.\n"+
								   "Go from left to right",
								   "Look for the CAPITAL LETTERS and DOUBLE SPACES on each line.\n "+
								   "Click each CAPITAL LETTER and the letters BEFORE and AFTER the DOUBLE SPACES.\n"+
								   "Go from left to right",
								   "Look for the CAPITAL LETTERS and DOUBLE SPACES on each line.\n "+
								   "Click each CAPITAL LETTER and the letters BEFORE and AFTER the DOUBLE SPACES.\n"+
								   "Go from left to right\n",
								   "Click 'STOP' when you are finished."
								   );

//c = capital letters, s = spaces (mark on each side of the space)
var testConditions:Array = new Array("c","c","s","s","cs","cs","cs");
var hasTimer:Array = new Array(true,true,true,true,true,true,false);
var commlocator:Array =new Array(
new Array(0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,4,4,4,5,5,6,6,6,6,7,7,7,7,7,8,8,8,9,9,9,9,10,11,11,12,12,12,12,12,13,13,13,14,14,14,14,14,14,14,15,15,16,16,16,17,17,17,18,18,18,18,18,18,19,19,19,20,20,20,20,20,20,20,21,21,21,21,22,22,23,23,23,24,24,25,25,25,25,25,25,25,25,25,26,26,26,27,27,27,27,28,28,28,28,28,28,29,29,30,30,30,30,31,31,31,31,32,32,32,32,33,33,33,33,33,34,34,34,34,34,35,35,35,35,35,36,36,37,37,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,43,43,43,43,43,43,44,44,44,44,45,45,45,45,45,45,45,45,46,46,47,47,47,47,48,48,49,49,50,50,50,50,50,50,50,50,51,51,51,52,52,52,52,53,54,54,54,54,54,54,54,54,54,54,55,55,55,56,56,56,57,57,57,58,58,58,59,59,59,59,60,60,60,60,61,61,62,62,63,63,63,64,64,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,68,68,68,68,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,72,72,72,72,72,73,73,74,74,75,75,75,75,76,76,76,76,77,77,77,77,78,78,79,79,79,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,82,82,82,83,83,83,83,83,83,84,84,84,84,84,84,84,85,85,85,86,87,87,88,88,88,88,88,88,89,89,90,90,90,90,90,90,90,90,90,90,90,90,91,92,92,92,92,92,93,93,93,94,95,95,95,95,95,95,95,95,95,95,96,96,97,97,98,98,98,98,99,100,100,100,100,100,100,101,101,102,102,103,103,103,104,104,104,105,105,105,106,106,106,106,106,106,106,107,108,108,108,108,108,108,108,109,109,109,109,109,109,110,110,110,110,111,111,112,112,112,112,112,112,112,112,113,113,113,113,114,114,115,115,115,115,115,116,116,116,117,117,118,118,119,119,119,119,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,121,121,121,122,122,122,122,122,122,123,123,123,123,124,124,125,125,125,125,125,125,126,126,126,126,127,127,128,128,128,128,128,128,129,129,129,129,130,130,130,130,130,131,131,131,131,132,132,133,133,134,134,135,135,135,135,135,135,135,135,135,135,135,135,136,136,137,137,137,137,137,138,138,139,140,140,140,140,140,141,141,141,142,142,142,142,142,142,142,142,143,143,143,143,144,144,145,145,145,145,145,146,146,147,148,148,148,148,149,149,149,149,149,149,150,150,150,150,150,150,151,151,152,152,152,152,152,153,153,153,154,154,154,155,155,155,155,155,155,155,155,155,155,156,156,156,157,157,157,157,157,158,158,158,158,159,159,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,161,161,161,161,161,161,161,162,162,162,162,163,163,164,165,165,165,165,165,165,165,165,165,165,165,166,166,166,167,167,167,167,168,168,169,170,170,170,170,170,171,171,171,171,172,172,172,173,174,174,174,174,174,174,175,175,175,175,175,175,175,175,176,176,176,177,177,177,177,178,178,178,179,179,179,179,179,180,180,180,181,181,181,182,182,182,183,183,183,183,184,184,185,185,185,185,185,185,185,186,186,186,186,187,187,187,187,187,187,188,189,189,189,189,189,189,190,190,190,190,191,192,192,192,193,193,193,193,193,193,193,193,194,194,194,195,195,195,195,195,196,197,197,197,197,197,197,197,198,198,198,198,199,199,199,199,200,200),
new Array(0,0,0,1,1,1,1,1,2,2,2,2,2,2,3,3,3,4,5,5,5,5,5,5,5,5,5,6,7,7,8,8,8,8,8,8,8,9,9,10,11,11,11,11,11,11,12,12,12,12,12,13,13,14,14,14,14,15,15,15,15,15,15,15,16,16,16,16,16,17,17,17,18,18,19,19,19,20,20,20,20,20,20,21,21,22,22,22,23,23,24,24,24,24,24,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,27,27,28,29,29,29,29,29,30,30,30,31,32,32,32,32,32,33,33,33,33,33,34,34,34,35,35,35,35,35,35,36,36,36,37,37,37,37,37,38,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,42,42,42,42,42,43,44,44,44,45,45,45,45,45,46,46,47,47,47,47,48,48,49,49,50,50,50,50,50,50,50,50,50,50,50,51,51,51,52,52,52,52,53,53,53,53,53,53,53,54,54,55,55,55,56,56,57,57,57,58,58,58,58,59,59,59,59,59,60,60,60,60,60,60,60,61,61,61,61,62,62,62,62,63,63,63,63,64,64,64,65,65,65,65,65,65,66,66,67,68,68,69,69,69,69,69,69,69,69,69,70,70,70,70,71,71,71,71,71,71,71,72,72,73,73,73,74,74,74,74,74,75,75,75,75,75,75,75,75,75,76,76,76,76,77,77,77,77,78,78,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,81,82,82,82,83,83,83,83,84,84,85,85,85,85,85,85,85,85,85,85,86,86,86,87,87,87,88,88,88,88,89,89,89,89,90,90,90,90,91,91,92,92,92,92,92,93,93,93,93,94,94,94,95,95,95,95,95,95,96,96,96,96,97,97,97,97,98,98,98,99,99,99,99,100,100,100,101,101,101,101,101,101,102,102,102,102,103,103,104,104,104,105,105,105,105,105,105,105,105,106,106,106,106,107,107,107,107,107,108,108,108,108,109,109,109,110,111,111,111,111,111,112,112,112,113,113,113,114,114,114,114,114,114,115,115,115,115,115,115,116,116,117,117,117,118,119,119,119,119,119,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,121,121,122,123,123,123,123,123,123,123,123,124,125,125,125,125,125,126,126,126,126,126,126,127,127,127,128,128,129,130,130,130,130,130,130,130,131,132,132,132,133,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,136,136,136,136,137,137,137,137,137,138,138,138,139,139,139,139,140,140,140,140,141,141,141,141,141,141,142,143,143,143,143,143,143,143,143,144,145,145,145,145,145,145,145,145,145,145,145,146,146,147,147,147,147,148,148,149,149,150,150,151,152,152,152,152,152,153,154,154,154,154,154,154,154,155,155,155,155,155,155,155,155,155,156,156,157,157,158,158,158,158,158,158,158,159,159,159,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,161,161,161,161,162,162,162,162,163,163,163,163,164,164,165,165,165,165,165,165,165,165,166,166,166,167,167,168,168,168,168,169,169,169,170,170,170,170,170,170,170,171,171,171,171,172,173,173,174,174,174,174,174,174,175,175,175,175,175,175,175,175,175,175,176,176,176,177,177,177,177,177,177,177,177,177,178,179,179,180,181,181,182,182,182,182,182,183,183,184,184,184,184,184,185,185,185,185,185,185,185,185,185,185,185,186,186,186,186,186,187,187,187,188,188,189,189,189,190,190,191,191,191,191,191,192,192,192,192,193,193,193,193,194,194,194,195,195,195,195,195,195,195,196,196,197,198,198,198,198,198,199,199,199,199,200,200,200,200,200),
new Array(0,0,0,0,0,0,1,1,2,2,2,2,2,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,6,6,7,7,7,7,7,7,7,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,11,11,12,12,12,12,12,12,13,13,14,14,14,14,14,14,14,14,15,15,16,16,16,16,16,16,17,17,18,18,18,18,18,18,18,18,18,18,18,18,19,19,20,20,20,20,20,21,21,22,22,22,23,23,23,23,23,23,24,24,24,24,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,28,28,28,28,28,28,28,28,29,29,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,33,33,34,34,34,34,34,34,34,34,34,34,34,34,35,35,36,36,36,36,36,36,36,37,37,38,38,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,42,42,43,43,43,43,43,43,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,49,50,50,51,51,51,51,51,51,51,51,51,51,52,52,53,53,53,53,53,53,53,53,53,53,53,54,54,55,55,55,55,55,56,56,57,58,58,59,59,59,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,63,63,63,63,63,63,64,64,65,65,66,66,66,66,66,66,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,70,70,70,70,70,70,70,70,71,71,72,72,72,72,72,72,72,73,73,74,74,75,75,75,75,75,75,75,75,75,75,76,76,77,77,78,78,78,78,78,78,78,79,79,80,80,80,80,80,80,80,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,84,84,84,84,84,85,85,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,87,87,88,88,88,88,88,88,89,89,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91,91,92,92,92,92,92,92,93,93,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,95,95,96,96,96,96,96,96,97,97,98,99,99,100,100,100,100,100,100,100,100,101,101,102,102,102,102,102,102,102,102,102,102,102,102,102,103,103,104,105,105,106,106,106,106,106,106,106,106,106,106,106,106,106,106,107,107,108,108,108,108,108,108,108,108,108,109,109,110,111,111,112,112,112,112,112,112,112,112,113,113,114,114,114,114,114,114,114,114,114,114,114,114,114,114,115,115,116,116,117,117,117,117,117,117,117,117,117,117,117,117,117,118,118,119,119,119,119,119,119,120,120,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,122,122,123,123,123,123,123,123,123,123,123,123,124,124,125,125,125,125,125,125,126,126,127,127,127,127,127,127,128,128,129,129,129,129,129,129,129,129,129,130,130,131,131,131,131,131,131,131,131,132,132,133,133,133,133,133,133,133,133,133,134,134,135,135,135,135,135,135,135,135,135,135,135,136,136,137,137,137,137,137,137,137,137,137,137,137,137,138,138,139,139,139,139,139,140,140,141,141,142,142,143,143,143,143,143,143,143,143,143,144,144,145,145,145,145,145,145,146,146,146,146,146,147,147,148,148,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,150,150,151,151,151,151,151,151,152,152,153,153,153,153),
new Array(1,1,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,9,9,9,9,9,9,10,10,11,11,11,11,11,11,11,11,11,11,11,12,12,13,13,13,13,13,14,14,15,15,15,15,15,15,16,16,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,20,20,20,20,21,21,22,22,22,22,22,22,22,22,22,23,23,24,24,24,24,24,25,25,26,26,26,26,26,26,26,26,26,27,27,28,28,28,28,28,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,32,32,32,32,32,32,32,32,32,32,32,33,33,34,34,34,34,34,34,34,34,35,35,36,36,36,36,37,37,38,38,38,38,38,38,38,38,38,38,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,42,42,42,43,43,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,49,49,49,50,50,51,51,52,52,52,52,52,53,53,54,54,55,55,56,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,62,62,62,62,62,62,62,62,62,62,63,63,64,64,64,64,64,65,65,66,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,70,70,70,70,70,70,70,70,70,70,71,71,72,72,72,72,72,72,72,72,73,73,74,75,75,76,76,76,76,77,77,78,78,78,78,78,78,79,79,80,80,80,81,81,82,82,82,83,83,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,85,85,86,86,86,86,87,87,88,88,88,88,88,88,89,89,90,90,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,92,92,93,94,94,95,95,95,95,95,95,95,95,95,95,95,95,96,96,97,97,97,97,97,97,97,97,97,97,97,98,98,99,99,99,99,99,99,99,99,99,99,99,99,100,100,101,102,102,103,103,103,103,103,103,103,103,103,103,103,104,104,105,105,105,105,105,105,105,105,105,106,106,107,107,107,107,107,107,108,108,109,110,110,111,111,111,111,111,112,112,113,113,113,113,113,113,113,113,113,113,113,113,114,114,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,116,116,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,118,118,119,119,120,120,120,120,120,120,121,121,122,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,124,124,124,124,124,124,124,124,125,125,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,127,127,128,128,128,128,128,129,129,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,131,131,132,132,133,133,134,134,135,135,135,135,135,135,135,135,136,136,137,137,137,137,137,138,138,139,140,140,141,141,141,141,141,142,142,143,143,143,143,143,143,143,143,144,144,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,146,146,147,147,147,147,147,147,147,147,147,147,148,148,149,149,149,149,149,149,149,149,149,150,150,151,151,151,151,152,152,153,153,153,153,153,153,153),
new Array(0,1,2,2,2,2,3,3,4,5,5,6,6,7,7,7,8,8,9,9,9,10,10,11,11,12,12,13,13,14,14,15,15,15,15,16,16,16,16,16,16,16,17,17,17,18,18,19,19,19,20,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,28,29,29,30,30,30,30,30,31,31,31,32,33,33,34,34,35,35,35,35,35,35,35,35,35,35,35,36,36,37,37,37,38,38,39,39,40,40,40,40,40,40,41,42,42,42,43,43,44,44,45,45,46,46,46,46,47,47,48,49,49,49,49,49,50,51,51,51,51,51,51,51,51,51,52,53,53,54,54,54,55,55,56,56,56,57,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,61,61,62,62,62,62,62,63,63,63,64,64,65,65,66,66,66,66,67,67,67,67,67,68,68,69,69,69,69,70,70,71,72,72,72,73,73,73,74,74,75,75,76,76,76,76,77,77,77,78,78,79,79,79,79,80,80,80,80,80,81,81,81,82,82,82,82,82,82,82,83,84,84,85,86,87,87,87,88,88,88,89,89,89,89,89,89,89,90,90,91,91,92,93,93,94,94,95,95,96,96,96,96,97,97,97,97,97,97,98,98,99,100,100,100,101,101,101,102,102,103,103,104,104,105,105,106,107,107,108,108,108,108,108,108,109,109,110,110,111,111,111,111,112,112,113,113,114,114,114,115,115,115,116,116,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,118,118,119,119,119,119,120,120,120,120,120,120,121,122,122,123,123,124,124,124,125,125,126,126,127,127,127,128,128,128,129,129,130,130,130,130,131,131,131,131,131,132,132,133,133,133,134,135,135,135,135,136,136,136,137,137,138,138,139,139,139,140,140,141,141,141,142,143,143,144,144,145,146,146,147,147,147,147,147,147,147,148,148,149,149,149,150,150,151,151,152,152,152,152,152,152,152,153,153,154,154,154,154,154,155,156,156,156,156,157,158,158,159,159,160,161,161,161,161,161,161,162,162,162,163,163,163,164,164,165,165,166,166,167,167,167,168,168,169,169,170,170,170,171,171,172,173,173,173,173,173,174,174,175,175,176,176,177,177,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,179,179,180,180,181,181,181,182,182,183,183,184,185,185,185,185,185,185,185,185,185,185,185,185,186,186,187,188,188,189,190,190,191,191,192,192,192,192,192,192,193,193,193,194,194,195,195,196,196,196,197,197,198,198,198,199,199,200,200,201,201,202,203,203,203,203,203,203,204,204,205,205,205,206,206,206,207,207,207,207,207,207,208,209,209,209,210,210,211,211,211,212,212,213,213,214,214,215,216,216,217,218,218,219,219,220,220,221,221,221,221,221,221,221,221,221,221,222,222,222,223,223,223,224,224,224,225,226,226,227,227,227,227,228,228,229,229,230,231,231,232,232,233,233,233,234,234,235,235,235,235,235,235,236,236,236,237,237,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,239,239,239,239,239,239,239,240,241,241,242,242,243,243,244,244,245,245,246,246,247,247,248,248,248,248,249,249,250,250,251,251,252,252,252,252,253,254,254,255,255,256,257,258,258,259,259,259,259,259,260,261,261,262,262,263,263,263,263,263,264,264,265,265,265,265,265,265,266,266,267,268,268,269,269,270,270,270,270,270,270,271,272,272,273,273,274,274,275,275,275,275,275,276,276,276,276,277,277,277,277,277,277,278,278,279,279,280,280,281,281,281,281,282,282,283,283,283,284,284,285,286,286,287,287,288,289,289,290,290,290,291,291,292,292,292,292,292,292,292,292,292,292,292,292,293,293,294,294,294,295,295,296,297,297,298,298,298,299,299),
new Array(0,0,0,1,1,1,1,1,2,2,3,3,4,5,5,6,7,7,8,8,8,8,8,9,9,10,10,10,11,11,11,12,12,12,13,13,14,15,15,16,16,17,17,17,18,18,18,19,19,20,20,20,20,21,21,21,22,22,23,24,24,25,25,25,25,25,25,25,25,25,26,27,27,28,28,28,29,29,30,30,30,31,32,32,33,33,34,34,34,34,35,35,36,36,36,36,37,37,38,38,38,39,39,40,41,42,42,42,43,43,44,44,44,45,45,45,46,46,47,47,48,49,49,49,49,50,50,51,51,52,53,53,53,54,54,54,55,55,55,55,55,55,56,56,57,58,59,59,60,60,61,61,61,61,61,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,65,65,66,66,66,67,67,68,69,69,69,70,71,71,71,72,72,73,74,74,75,75,76,76,76,77,77,77,77,78,78,79,79,79,80,80,80,81,82,82,83,83,84,84,84,84,84,85,85,86,86,86,86,87,87,88,88,88,88,89,89,90,90,90,90,90,90,90,91,91,92,92,93,93,94,95,95,96,96,97,97,98,98,98,99,99,99,100,100,101,101,101,101,101,101,101,101,102,102,103,103,104,104,105,105,106,107,107,107,108,108,108,108,109,110,110,111,111,112,112,112,113,113,113,114,114,114,115,115,115,115,115,115,116,116,117,117,118,118,119,119,120,120,120,120,120,121,121,121,122,122,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,124,125,125,126,126,126,127,127,128,128,129,129,129,129,129,130,131,131,131,131,131,132,132,133,134,134,134,135,135,135,136,136,137,138,138,139,139,139,139,139,140,140,141,141,142,142,142,143,144,144,145,145,146,146,146,146,146,146,147,147,148,148,148,149,149,150,150,151,152,152,153,153,154,154,155,155,155,155,155,155,156,156,156,157,157,158,159,159,160,160,160,160,161,161,162,162,162,163,163,163,163,164,164,165,166,166,166,166,167,168,168,169,169,170,170,170,170,171,171,171,172,172,173,173,173,174,175,175,176,177,177,177,177,178,178,178,179,179,180,180,180,180,180,180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,187,188,188,189,189,189,189,189,189,189,190,190,191,191,192,193,193,194,194,194,195,195,195,196,196,196,197,197,197,198,198,199,199,199,200,200,201,202,202,203,203,204,204,205,206,206,207,208,208,208,208,208,208,209,209,210,210,210,210,211,211,211,211,212,212,213,213,213,214,214,214,215,215,215,216,216,217,217,218,219,219,220,220,221,221,222,222,223,223,223,223,223,223,224,224,225,225,226,226,227,227,227,228,228,229,229,229,230,230,231,231,232,232,232,233,233,234,234,235,235,236,236,237,237,238,238,238,239,239,240,241,241,242,242,242,242,242,242,243,243,244,244,245,245,245,245,246,247,247,248,248,248,249,249,249,249,250,250,251,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,253,253,253,253,254,255,255,255,255,255,256,256,256,256,256,257,258,258,259,259,259,260,260,261,261,262,262,263,264,264,265,265,266,266,266,267,267,267,267,267,267,268,268,269,270,270,271,272,272,272,273,273,273,274,274,275,275,275,276,276,276,276,277,278,279,279,280,280,280,281,281,281,282,282,283,283,283,283,284,285,286,286,286,287,287,287,288,288,288,288,288,289,289,289,290,290,291,291,292,292,292,293,294,294,295,295,296,296,297,297,297,298,298,298,298,299,299,300,300,300,300,301,301,302,302,303,303,304,305,305,305,306,306,307,307,307,307,307,307,307,308,308,308,309,309,309,309,310,310,311,311,312,312,312,312,312,312,312,312,312),
new Array(310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310)
);

//RESULTS
var commpos:Array =new Array(0,0,0,0,0,0,0);
var times:Array = new Array(strings.length);
var hits:Array = new Array(strings.length);
var ommissions:Array = new Array(strings.length);
var commissions:Array = new Array(strings.length);

var verticalOffset:Number = 120;
var horizontalOffset:Number = 15;
var gridSize:Number = 19;
var splitAtRow:Number = 4;
//var testtimelimit:Number = 60000;
var depth:Number = 100;

var pressToStop:Boolean = false;
var instructionDisplayed:Boolean = false;
var timerID:Number;
var startTime:Number;
var maxRowsPerPage:Number = 20;
var outputServer:String;


function loadInput()
{
	testtimelimit=60000;
}

loadInput();

var pageNumber:Number;
pageNumber=0;
testNumber=0;
instruction_txt.html = true;
var story:XML = new XML();
story.ignoreWhite = true;
story.load("modules/common-code/flash/LCT_"+pageNumber.toString()+".htm?a=1");
story.onLoad = function () {	
	instruction_txt.htmlText = story;
}
pageNumber=pageNumber+1;

testFinished_txt._visible = false;
//instruction_txt.text = "This task is called a cancellation task. ";


next_btn.onPress = function()
{
	//Start Test
	if (instructionDisplayed)
	{
		instructionDisplayed = false;
		
		instruction_txt._visible = false;
		generateGrid();
		Mouse.addListener(mouseListener);
		
		startTime = getTimer();
		if (hasTimer[testNumber])
		{
			timerID = setInterval(timesUp,testtimelimit);
			next_btn._visible = false;
		}
		else
		{
			next_btn.label = "Stop";
			pressToStop = true;
		}
	}
	
	//Stop Test
	else if (pressToStop)
	{
		pressToStop = false;
		next_btn._visible = false;
		
		Mouse.removeListener(mouseListener);
		clearGrid(testNumber,false);
		//testFinished_txt._visible = true;
		nextTest();
	}
	
	//Show Instructions
	else
	{
		instructionDisplayed = true;		

		//instruction_txt.text = instructions[testNumber];
	
		//testFinished_txt._visible = false;
		story.load("modules/common-code/flash/LCT_"+pageNumber.toString()+".htm?a=1");
		story.onLoad = function () {	
		instruction_txt.htmlText = story;		
		}
		instruction_txt._visible = true;
		next_btn.label = "Start";
	}
}

function timesUp()
{
	clearInterval(timerID);
	Mouse.removeListener(mouseListener);
	clearGrid(testNumber,false);
	//testFinished_txt._visible = true;
	nextTest();
}

//Make button available to start next test
function nextTest()
{
	if (testNumber+1 < strings.length)
	{
		pageNumber = pageNumber + 1;
		testNumber = testNumber + 1;
		next_btn.label = "Next";
		next_btn._visible = true;
	}
	else
	{
		//testFinished_txt.text = "Finished - Call Supervisor";
		uploadResults();
		trace(times);
	}
}

function saveGrid(testNum:Number)
{
	var maxRow:Number = maxRowsPerPage;
	
	for(row = 0; row < strings[testNum].length && row < maxRow; row++)
	{			
		for (col = 0; col < strings[testNumber][0].length; col++)
		{
			var letter_X_X_txt:TextField;
			
			var leftLetter:String;
			var letter:String;
			var rightLetter:String;
			
			letter_X_X_txt = eval("letter_"+row+"_"+col+"_txt");
			letter = letter_X_X_txt.text;
			letter_X_X_txt = eval("letter_"+row+"_"+(col-1)+"_txt");
			leftLetter = letter_X_X_txt.text;
			letter_X_X_txt = eval("letter_"+row+"_"+(col+1)+"_txt");
			rightLetter = letter_X_X_txt.text;
						
			var leftMarked:Boolean;
			var marked:Boolean;
			var rightMarked:Boolean;
			
			var cross_X_X_mc:MovieClip;
			
			cross_X_X_mc = eval("cross_"+(row)+"_"+col+"_mc");
			if (cross_X_X_mc == undefined)
			{
				marked = false;
			}
			else
			{
				marked = true;
			}
			cross_X_X_mc = eval("cross_"+(row)+"_"+(col-1)+"_mc");
			if (cross_X_X_mc == undefined)
			{
				leftMarked = false;
			}
			else
			{
				leftMarked = true;
			}
			cross_X_X_mc = eval("cross_"+(row)+"_"+(col+1)+"_mc");
			if (cross_X_X_mc == undefined)
			{
				rightMarked = false;
			}
			else
			{
				rightMarked = true;
			}
	
			//CHECK IF CAPITAL LETTERS SURROUND SPACE, ONLY MARK AS SINGLE HIT!!
			// if "CAPITAL" letters are involved
			trace(testConditions[testNum]);
			if (testConditions[testNum] == "c")
			{
				if (isUpperCaseAlpha(letter))
				{
					if (marked)
					{
						hits[testNum]++;
					}
				}
				else
				{
					if (marked)
					{
						commissions[testNum]++;
					}
				}
			}
			if (testConditions[testNum] == "s")
			{
				if (marked && (isSpace(leftLetter) || isSpace(rightLetter)))
				{
					hits[testNum]++;
				}
				else
				{
					if (marked)
					{
						commissions[testNum]++;
					}
				}
			}
			if (testConditions[testNum] == "cs")
			{
				if (marked && (isSpace(leftLetter) || isSpace(rightLetter)))
				{
					hits[testNum]++;
				}
				else
				{
					if (marked && isUpperCaseAlpha(letter))
					{
						hits[testNum]++;						
					}
					else
					{
						if (marked)
						{
							commissions[testNum]++;
						}
					}
				}				
			}
		}
	}
	ommissions[testNum]=commpos[testNum]-hits[testNum];
}

function isUpperCaseAlpha(char:String):Boolean
{
	if (char.charCodeAt(0) >= 65 && char.charCodeAt(0) <= 90)
	{
		return true;
	}
	else
	{
		return false;
	}
}

function isSpace(char:String):Boolean
{
	if (char.charCodeAt(0) == 32)
	{
		return true;
	}
	else
	{
		return false;
	}
}

function clearGrid(testNum:Number, morePages:Boolean)
{
	if (!morePages)
	{
		times[testNum] = getTimer()-startTime;
	}
	
	saveGrid(testNum);
	trace(hits);
	trace(ommissions);
	trace(commissions);
	
	for(row = 0; row < strings[testNum].length; row++)
	{
		for (col = 0; col < strings[testNum][0].length; col++)
		{
			var letter_X_X_txt:TextField = eval("letter_"+row+"_"+col+"_txt");
			if (letter_X_X_txt != undefined)
			{
				letter_X_X_txt.removeTextField();
			}
						
			var cross_X_X_mc:MovieClip = eval("cross_"+row+"_"+col+"_mc");
			if (cross_X_X_mc != undefined)
			{
				cross_X_X_mc.removeMovieClip();
			}
		}
	}
}

function generateGrid()
{
	var letter_X_X_txt:TextField;
	var xPosition:Number;
	var yPosition:Number;
	var row:Number;
	var col:Number;

	hits[testNumber] = 0;
	ommissions[testNumber] = 0;
	commissions[testNumber] = 0;
		
	yPosition = verticalOffset;
	
	var maxRow:Number = maxRowsPerPage;
	
	for(row = 0; row < strings[testNumber].length && row < maxRow; row++)
	{
		xPosition = horizontalOffset;
		
		for (col = 0; col < strings[testNumber][0].length; col++)
		{
			depth = depth + 1;
			var format:TextFormat = new TextFormat();
			format.align = "center";
			format.size = 12;
			format.font="Lucida Console";
			
			letter_X_X_txt = this.createTextField("letter_"+row+"_"+col+"_txt",depth,xPosition,yPosition,gridSize,gridSize);
			letter_X_X_txt.text = strings[testNumber][row].charAt(col);
			letter_X_X_txt.setTextFormat(format);
			letter_X_X_txt.selectable = false;

			xPosition = xPosition + gridSize;
		}
	
		if(row % splitAtRow == 3)
		{
			yPosition = yPosition + gridSize;
		}
	
		yPosition = yPosition + gridSize;
	}

}

var mouseListener:Object = new Object();

mouseListener.onMouseDown = function()
{
	var col:Number;
	var row:Number;
	var temppos:Number;
	
	col = Math.floor((_xmouse-horizontalOffset)/gridSize);
	row = Math.floor((_ymouse-verticalOffset)/gridSize);
	temppos=commlocator[testNumber][row*40+col];
	if (commpos[testNumber] < temppos)
	{
		commpos[testNumber]=temppos;
	}
	if ((row+1) % (splitAtRow+1) == 0)
	{
		return;
	}
	
	row = row - (Math.floor((row+1)/(splitAtRow+1)));
	
	var cross_X_X_mc:MovieClip = eval("cross_"+row+"_"+col+"_mc");
	
	if (cross_X_X_mc == undefined)
	{
		if (row >= 0 && row < strings[testNumber].length)
		{
			if (col >= 0 && col < strings[testNumber][row].length)
			{
				depth = depth + 1;
				var xPosition:Number = horizontalOffset + gridSize*(col)+((gridSize-12)/2);
				var yPosition:Number = verticalOffset + gridSize*(row)+((gridSize-12)/2)+(Math.floor(row/splitAtRow)*gridSize);
				_level0.attachMovie("Cross","cross_"+row+"_"+col+"_mc",depth,{_x:xPosition,_y:yPosition});
			}
		}	
	}
	else
	{
		cross_X_X_mc.removeMovieClip();
	}
}

function uploadResults()
{	
	//ver 3 call javascript
	var param='&duration_0='+times[0].toString()+'&hits_0='+ hits[0].toString()+'&omissions_0='+ommissions[0].toString()+'&commissions_0='+commissions[0].toString()+
			'&duration_1='+times[1].toString()+'&hits_1='+ hits[1].toString()+'&omissions_1='+ommissions[1].toString()+'&commissions_1='+commissions[1].toString()+
			'&duration_2='+times[2].toString()+'&hits_2='+ hits[2].toString()+'&omissions_2='+ommissions[2].toString()+'&commissions_2='+commissions[2].toString()+
			'&duration_3='+times[3].toString()+'&hits_3='+ hits[3].toString()+'&omissions_3='+ommissions[3].toString()+'&commissions_3='+commissions[3].toString()+
			'&duration_4='+times[4].toString()+'&hits_4='+ hits[4].toString()+'&omissions_4='+ommissions[4].toString()+'&commissions_4='+commissions[4].toString()+
			'&duration_5='+times[5].toString()+'&hits_5='+ hits[5].toString()+'&omissions_5='+ommissions[5].toString()+'&commissions_5='+commissions[5].toString()+
			'&duration_6='+times[6].toString()+'&hits_6='+ hits[6].toString()+'&omissions_6='+ommissions[6].toString()+'&commissions_6='+commissions[6].toString();
	ExternalInterface.call("g_lct_callback",param);
	testFinished_txt._visible = false;
}
